
<% if current_user  %>
  <div class="row">
    <div class="col l2"></div>
    
    <div class="col s12 m7 l8">
    <h2>InstaFeed</h2>
      <div class="card">
        <div class="pad-block pad-left col l8">
        <%= current_user.name %>
        </div>
       
          <div class="card-content">
            <div class="row">
              <%= form_with(model: @post, local: true) do |f| %>
                <div class="input-field col s12">
                <i class="material-icons prefix">textsms</i>
                <%= f.label :content %>
                <%= f.text_field :content  %>
                <%# <label for="autocomplete-input">What are your thoughts ...</label> %>
                    
                </div>
                 </div>
                </div>
                <div class="card-action">
                  <a ><%= f.submit %></a>
                </div>
              <% end %>

      </div>
    </div>
  </div>
  <div>
    <div class="row">
    <div class=" col l2"></div>
    <div class="col l8"> 
    <!-- show post -->
    <% @posts.each do |post| %>
      <div class="card">

         <div class="card-content">
            <span class="card-title activator grey-text text-darken-4">
         
            <div class="name"><%= post.user.name %></div>
            <div class="pad-block"> <%= post.content %></div>
              <div class="row  pad-block">
              <%= form_with(model: @like, local: true) do |f| %>
              <%= f.hidden_field :post_id, value: post.id %>
                <div class="col lg1"> <%= f.submit %></div>
              <% end %>  
                <!--usar Javascript expandir y recoger comment que esta mas abajo -->
                <div class="col lg1">Comment </div>
                <% if current_user == post.user %>
                  <div class="col lg1"><%= link_to 'Edit', edit_post_path(post) %></div>
                  <div class="col lg1"><%= link_to "Delete", post_path(post.id), :method => :delete %></div>
                <% end %>
              </div>
         
          </div>
        </div>
        <!--show comments -->
          <% post.comments.each do |comment| %>
            <div class="card-content">
                  <div class="row">
                    <div class="col l2"></div>  
                    <div class="commenter l8"><%= comment.user.name %></div>
                      <div class="row">
                        <% if current_user == comment.user %>
                        <div class="col l2"></div>
                          <div class="col l5"> <%= comment.content %></div>
                          <div class="col l1"><%= link_to 'Edit', edit_comment_path(comment) %></div>
                          <div class="col l1"><%= link_to "Delete", comment_path(comment.id), :method => :delete %></div>
                        <% end %>
                      </div>
              </div>
            </div>
          <% end %>
        <!-- write comment -->
        <div class="card-content">
          <div class="row">
              <%= form_with(model: @comment, local: true) do |f| %>
                <div class="input-field col s12">
                <i class="">Comment</i>
                <%= f.label :content %>
                <%= f.text_field :content  %>
                <%= f.hidden_field :post_id, value: post.id %>
                </div>
                <div class="card-action">
                  <a ><%= f.submit %></a>
                </div>
              <% end %>
          </div>
        </div>
        
    <% end %>
    <!-- end show post  -->

    </div>
    </div>
</div>
<% else %>
  <div class="row">
    <div class="col l3"></div>
      
      <div class="col s12 m7 l6 center-align">
      <h2 >BookFace</h2>
      <h3>Please become a user</h3>
      <h3>You would not regret it ;)</h3>

      <%= link_to 'Sign up', new_user_registration_path %>
      <%= link_to 'Sign in', new_user_session_path %>
    </div>
  </div>
<% end %>
